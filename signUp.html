<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Sign Up - Sharvari's Wardrobe</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css">
  <style>
    :root {
      --primary-color: #5ca7e1;
      --secondary-color: #8ebfe4;
      --accent-color: #806C37;
      --light-bg: #FAF3DD;
    }

    body {
      background-color: #f8f9fa;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    .form-container {
      max-width: 480px;
      background-color: var(--light-bg);
      border-radius: 10px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
      padding: 2rem;
      margin: 2rem auto;
    }

    .logo-img {
      width: 100px;
      height: auto;
      margin-bottom: 1.5rem;
    }

    .form-title {
      color: var(--primary-color);
      font-weight: 600;
      margin-bottom: 1.5rem;
    }

    .btn-primary-custom {
      background-color: var(--primary-color);
      border: none;
      padding: 0.5rem 1rem;
      font-weight: 500;
      transition: all 0.3s;
    }

    .btn-primary-custom:hover {
      background-color: #4a96d1;
      transform: translateY(-2px);
    }

    .form-floating label {
      color: #6c757d;
    }

    .form-control:focus {
      border-color: var(--secondary-color);
      box-shadow: 0 0 0 0.25rem rgba(92, 167, 225, 0.25);
    }

    .footer-text {
      color: var(--accent-color);
    }

    .nav-link {
      color: var(--primary-color);
    }

    .nav-link:hover {
      color: #4a96d1;
    }

    .is-invalid {
      border-color: #dc3545;
    }

    .invalid-feedback {
      color: #dc3545;
      font-size: 0.875rem;
    }

    .password-toggle {
      position: absolute;
      right: 10px;
      top: 50%;
      transform: translateY(-50%);
      cursor: pointer;
      z-index: 5;
      color: #6c757d;
    }
  </style>
</head>

<body class="d-flex flex-column min-vh-100">
  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container">
      <a class="navbar-brand" href="Bootstrap.html">
        <img src="images/img5.webp" alt="Sharvari's Wardrobe" height="40" class="d-inline-block align-top me-2">
        Sharvari's Wardrobe
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item">
            <a class="nav-link" href="Bootstrap.html">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="signUp.html">Login/Sign Up</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <main class="flex-grow-1 d-flex align-items-center">
    <div class="form-container">
      <form id="signupForm" novalidate>
        <div class="text-center">
          <img src="images/img5.webp" alt="Sharvari's Wardrobe Logo" class="logo-img">
        </div>

        <h1 class="h3 mb-4 text-center form-title">Create Your Account</h1>

        <div class="row">
          <div class="col-md-6 mb-3">
            <div class="form-floating">
              <input type="text" class="form-control" id="firstName" placeholder="First Name" required>
              <label for="firstName">First Name</label>
              <div class="invalid-feedback">Please enter your first name.</div>
            </div>
          </div>
          <div class="col-md-6 mb-3">
            <div class="form-floating">
              <input type="text" class="form-control" id="lastName" placeholder="Last Name" required>
              <label for="lastName">Last Name</label>
              <div class="invalid-feedback">Please enter your last name.</div>
            </div>
          </div>
        </div>

        <div class="mb-3">
          <div class="form-floating">
            <input type="email" class="form-control" id="email" placeholder="Email Address" required>
            <label for="email">Email Address</label>
            <div class="invalid-feedback">Please enter a valid email address.</div>
          </div>
        </div>

        <div class="mb-3 position-relative">
          <div class="form-floating">
            <input type="password" class="form-control" id="password" placeholder="Password" required minlength="8">
            <label for="password">Password</label>
            <i class="far fa-eye password-toggle" id="togglePassword"></i>
            <div class="invalid-feedback">Password must be at least 8 characters long.</div>
          </div>
        </div>

        <div class="mb-3 position-relative">
          <div class="form-floating">
            <input type="password" class="form-control" id="confirmPassword" placeholder="Confirm Password" required>
            <label for="confirmPassword">Confirm Password</label>
            <div class="invalid-feedback">Passwords must match.</div>
          </div>
        </div>

        <div class="mb-3 form-check">
          <input type="checkbox" class="form-check-input" id="termsCheck" required>
          <label class="form-check-label" for="termsCheck">I agree to the <a href="#" data-bs-toggle="modal"
              data-bs-target="#termsModal">Terms and Conditions</a></label>
          <div class="invalid-feedback">You must agree to the terms and conditions.</div>
        </div>

        <button class="btn btn-primary-custom w-100 py-2 mb-3" type="submit">Sign Up</button>

        <div class="text-center">
          <p>Already have an account? <a href="#" id="showLoginLink">Log In</a></p>
        </div>
      </form>

      <!-- Login Form (hidden by default) -->
      <form id="loginForm" class="d-none" novalidate>
        <div class="text-center">
          <img src="images/img5.webp" alt="Sharvari's Wardrobe Logo" class="logo-img">
        </div>

        <h1 class="h3 mb-4 text-center form-title">Welcome Back</h1>

        <div class="mb-3">
          <div class="form-floating">
            <input type="email" class="form-control" id="loginEmail" placeholder="Email Address" required>
            <label for="loginEmail">Email Address</label>
            <div class="invalid-feedback">Please enter your email address.</div>
          </div>
        </div>

        <div class="mb-3 position-relative">
          <div class="form-floating">
            <input type="password" class="form-control" id="loginPassword" placeholder="Password" required>
            <label for="loginPassword">Password</label>
            <i class="far fa-eye password-toggle" id="toggleLoginPassword"></i>
            <div class="invalid-feedback">Please enter your password.</div>
          </div>
        </div>

        <div class="mb-3 form-check">
          <input type="checkbox" class="form-check-input" id="rememberMe">
          <label class="form-check-label" for="rememberMe">Remember me</label>
        </div>

        <button class="btn btn-primary-custom w-100 py-2 mb-3" type="submit">Log In</button>

        <div class="text-center">
          <p>Don't have an account? <a href="#" id="showSignupLink">Sign Up</a></p>
          <p><a href="#" data-bs-toggle="modal" data-bs-target="#forgotPasswordModal">Forgot password?</a></p>
        </div>
      </form>
    </div>
  </main>

  <!-- Terms and Conditions Modal -->
  <div class="modal fade" id="termsModal" tabindex="-1" aria-labelledby="termsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="termsModalLabel">Terms and Conditions</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <h6>1. Acceptance of Terms</h6>
          <p>By accessing or using Sharvari's Wardrobe, you agree to be bound by these Terms and Conditions.</p>

          <h6>2. User Accounts</h6>
          <p>You are responsible for maintaining the confidentiality of your account and password.</p>

          <h6>3. Privacy Policy</h6>
          <p>Your personal information will be handled in accordance with our Privacy Policy.</p>

          <h6>4. User Content</h6>
          <p>You retain ownership of any content you submit, but grant us a license to use it.</p>

          <h6>5. Prohibited Activities</h6>
          <p>You agree not to engage in any illegal or unauthorized activities using our service.</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Forgot Password Modal -->
  <div class="modal fade" id="forgotPasswordModal" tabindex="-1" aria-labelledby="forgotPasswordModalLabel"
    aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="forgotPasswordModalLabel">Reset Password</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <p>Enter your email address and we'll send you a link to reset your password.</p>
          <div class="mb-3">
            <label for="resetEmail" class="form-label">Email Address</label>
            <input type="email" class="form-control" id="resetEmail" required>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-primary" id="sendResetLink">Send Reset Link</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="py-3 mt-auto">
    <div class="container text-center">
      <p class="footer-text">© 2025 Sharvari's Wardrobe. All rights reserved.</p>
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      // Initialize forms based on URL
      const urlParams = new URLSearchParams(window.location.search);
      const action = urlParams.get('action');

      if (action === 'login') {
        showLoginForm();
      } else {
        showSignupForm();
      }

      // Setup toggle links
      document.getElementById('showLoginLink').addEventListener('click', function (e) {
        e.preventDefault();
        showLoginForm();
        history.pushState(null, '', 'signUp.html?action=login');
      });

      document.getElementById('showSignupLink').addEventListener('click', function (e) {
        e.preventDefault();
        showSignupForm();
        history.pushState(null, '', 'signUp.html?action=signup');
      });

      // Password toggle functionality
      document.getElementById('togglePassword').addEventListener('click', function () {
        togglePasswordVisibility('password', this);
      });

      document.getElementById('toggleLoginPassword').addEventListener('click', function () {
        togglePasswordVisibility('loginPassword', this);
      });

      // In your signup form submission handler:
      document.getElementById('signupForm').addEventListener('submit', async function (e) {
        e.preventDefault();
        if (validateSignupForm()) {
          try {
            const response = await fetch('http://localhost:5000/api/auth/register', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({
                firstName: document.getElementById('firstName').value,
                lastName: document.getElementById('lastName').value,
                email: document.getElementById('email').value,
                password: document.getElementById('password').value
              })
            });

            const data = await response.json();
            if (response.ok) {
              alert('Registration successful! Please log in.');
              showLoginForm();
            } else {
              // Display backend validation errors
              if (data.errors) {
                alert(data.errors.map(err => err.msg).join('\n'));
              } else {
                alert(data.message || 'Registration failed');
              }
            }
          } catch (error) {
            console.error('Error:', error);
            alert('An error occurred during registration');
          }
        }
      });

      // In your login form submission handler:
      document.getElementById('loginForm').addEventListener('submit', async function (e) {
        e.preventDefault();
        if (validateLoginForm()) {
          try {
            const response = await fetch('http://localhost:5000/api/auth/login', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({
                email: document.getElementById('loginEmail').value,
                password: document.getElementById('loginPassword').value
              })
            });

            const data = await response.json();
            if (response.ok) {
              localStorage.setItem('token', data.token);
              localStorage.setItem('user', JSON.stringify(data.user));
              window.location.href = 'Bootstrap.html';
            } else {
              alert(data.message || 'Login failed');
            }
          } catch (error) {
            console.error('Error:', error);
            alert('An error occurred during login');
          }
        }
      });

      // Forgot password handler
      document.getElementById('sendResetLink').addEventListener('click', async function () {
        const email = document.getElementById('resetEmail').value;
        if (!email) {
          alert('Please enter your email address');
          return;
        }

        try {
          const response = await fetch('http://localhost:5000/api/auth/forgot-password', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({ email })
          });

          const data = await response.json();
          if (response.ok) {
            alert('Password reset link sent to your email');
            bootstrap.Modal.getInstance(document.getElementById('forgotPasswordModal')).hide();
          } else {
            alert(data.message || 'Failed to send reset link');
          }
        } catch (error) {
          console.error('Error:', error);
          alert('An error occurred');
        }
      });

      // Field validation on blur
      document.getElementById('confirmPassword').addEventListener('blur', validatePasswordMatch);
    });

    function showLoginForm() {
      document.getElementById('signupForm').classList.add('d-none');
      document.getElementById('loginForm').classList.remove('d-none');
      document.title = "Login - Sharvari's Wardrobe";
    }

    function showSignupForm() {
      document.getElementById('loginForm').classList.add('d-none');
      document.getElementById('signupForm').classList.remove('d-none');
      document.title = "Sign Up - Sharvari's Wardrobe";
    }

    function togglePasswordVisibility(fieldId, iconElement) {
      const passwordField = document.getElementById(fieldId);
      if (passwordField.type === 'password') {
        passwordField.type = 'text';
        iconElement.classList.remove('fa-eye');
        iconElement.classList.add('fa-eye-slash');
      } else {
        passwordField.type = 'password';
        iconElement.classList.remove('fa-eye-slash');
        iconElement.classList.add('fa-eye');
      }
    }

    function validateSignupForm() {
      let isValid = true;
      const form = document.getElementById('signupForm');

      // Validate first name
      const firstName = document.getElementById('firstName');
      if (!firstName.value.trim()) {
        firstName.classList.add('is-invalid');
        isValid = false;
      } else {
        firstName.classList.remove('is-invalid');
      }

      // Validate last name
      const lastName = document.getElementById('lastName');
      if (!lastName.value.trim()) {
        lastName.classList.add('is-invalid');
        isValid = false;
      } else {
        lastName.classList.remove('is-invalid');
      }

      // Validate email
      const email = document.getElementById('email');
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (!emailRegex.test(email.value)) {
        email.classList.add('is-invalid');
        isValid = false;
      } else {
        email.classList.remove('is-invalid');
      }

      // Validate password
      const password = document.getElementById('password');
      if (password.value.length < 8) {
        password.classList.add('is-invalid');
        isValid = false;
      } else {
        password.classList.remove('is-invalid');
      }

      // Validate password match
      if (!validatePasswordMatch()) {
        isValid = false;
      }

      // Validate terms checkbox
      const termsCheck = document.getElementById('termsCheck');
      if (!termsCheck.checked) {
        termsCheck.classList.add('is-invalid');
        isValid = false;
      } else {
        termsCheck.classList.remove('is-invalid');
      }

      return isValid;
    }

    function validateLoginForm() {
      let isValid = true;
      const form = document.getElementById('loginForm');

      // Validate email
      const email = document.getElementById('loginEmail');
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (!emailRegex.test(email.value)) {
        email.classList.add('is-invalid');
        isValid = false;
      } else {
        email.classList.remove('is-invalid');
      }

      // Validate password
      const password = document.getElementById('loginPassword');
      if (!password.value.trim()) {
        password.classList.add('is-invalid');
        isValid = false;
      } else {
        password.classList.remove('is-invalid');
      }

      return isValid;
    }

    function validatePasswordMatch() {
      const password = document.getElementById('password');
      const confirmPassword = document.getElementById('confirmPassword');

      if (password.value !== confirmPassword.value) {
        confirmPassword.classList.add('is-invalid');
        return false;
      } else {
        confirmPassword.classList.remove('is-invalid');
        return true;
      }
    }
  </script>
</body>

</html>